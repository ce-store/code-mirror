<html>
<head>
  <script src="lib/codemirror.js"></script>
  <link rel="stylesheet" href="lib/codemirror.css">
  <link rel="stylesheet" href="theme/ambiance.css">
  <link rel="stylesheet" href="addon/hint/show-hint.css">
  <link rel="stylesheet" href="addon/lint/lint.css">
  <script src="addon/hint/show-hint.js"></script>
  <script src="addon/hint/ce-anyword-hint.js"></script>
  <script src="addon/lint/lint.js"></script>
  <script src="addon/selection/active-line.js"></script>
  <script src="mode/javascript/javascript.js"></script>
  <script src="mode/ce/ce.js"></script>

  <style>
    .CodeMirror {
      height: 500px;
    }
  </style>
</head>

<body>

<textarea id='code'>
-- Here is a conceptualise statement
conceptualise a ~ man ~ P that
  is a person and
  is an old man and
  has the value N as ~ age ~ and
  ~ is the sibling of ~ the value K and
  ~ is the sibling of ~ the man M.

there is a man named John that
  has 'fifty three' as age and
  has 53 as age and
  is the sibling of the person "Jill J".

-- incorrect syntax
there is an old man named Barry B that
  has the value fifty three as age and
  is the sibling of the person Jill J.

man

perform reset store with starting uid '1'.

perform load sentences from url '/ce-store/ce/general/agents/agent_model.ce'.

perform set 'ce root' to 'http://ce-models.eu-gb.mybluemix.net/medicine/'.

perform run the rule executor agent named 'med_rules'.
</textarea>

<script>
  var lastKeyPressed;

  CodeMirror.fromTextArea(document.getElementById('code'), {
    mode: 'ce',
    tabSize: 2,
    lineNumbers: true,
    lineWrapping: true,
    styleActiveLine: true,
    theme: 'ambiance',
    extraKeys: {
      Tab: function(cm) {
        var spaces = Array(cm.getOption("indentUnit") + 1).join(" ");
        cm.replaceSelection(spaces);
      }
    },
    // gutters: ["CodeMirror-lint-markers"],
    // lint: true
  })

  .on('keyup', function(cm, event) {
    // event.keyCodes: 91 = cmd, 17 = ctrl
    if (lastKeyPressed &&
        lastKeyPressed !== 91 &&
        lastKeyPressed !== 17) {
      // cm.state.completionActive enables keyboard navigation in autocomplete list
      // show autocomplete for a-z, A-Z, 0-9, - and _
      var input = String.fromCharCode(event.keyCode);
      if (!cm.state.completionActive &&
        (/[a-zA-Z0-9-_]/.test(input))) {
        CodeMirror.commands.autocomplete(cm, null, {completeSingle: false});
      }
    }

    lastKeyPressed = event.keyCode;
  })
</script>
</body>
</html>
